[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[],[d2,d3],[d1,d4];[],[d2],[d1,d3,d4];[d1],[d2], [d3,d4];[d1],[],[d2,d3,d4];[d1,d3],[],[d2,d4];[d3],[d1],[d2,d4];[d3],[d1,d2], [d4];[],[d1,d2,d3],[d4];[],[d1,d2],[d3,d4];[d3],[d1,d2], [d4];[d2,d3],[d1], [d4];[d2,d3],[],[d1,d4];[d2],[d3],[d1,d4];[d2],[],[d1,d3,d4];[d2,d4],[],[d1,d3];[d4],[d2],[d1,d3];[d4],[d1,d2], [d3];[],[d1,d2,d4],[d3];[],[d1,d2],[d3,d4];[d3],[d1,d2], [d4];[d2,d3],[d1], [d4];[d2,d3],[],[d1,d4];[d2],[d3],[d1,d4];[d2],[],[d1,d3,d4];[],[d2],[d1,d3,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1,d4],[d2,d3],[];[d1],[d2,d3,d4],[];[],[d2,d3,d4],[d1];[],[d3,d4],[d1,d2];[d3],[d4],[d1,d2];[d3],[],[d1,d2,d4];[d3],[d2],[d1,d4];[d3,d4],[],[d1,d2];[],[d3],[d1,d2,d4];[],[],[d1,d2,d3,d4]
?Okay, here's the requested formatting of the Tower of Hanoi solution for 4 disks:

[d4,stack1,stack2];[d3,stack1,stack3];[d4,stack2,stack3];[d2,stack1,stack2];[d4,stack3,stack1];[d3,stack3,stack2];[d4,stack1,stack2];[d1,stack1,stack3];[d4,stack2,stack3];[d3,stack2,stack1];[d4,stack3,stack1];[d2,stack2,stack3];[d4,stack1,stack2];[d3,stack1,stack3];[d4,stack2,stack3];[d1,stack1,stack2];[d4,stack3,stack1];[d3,stack3,stack2];[d4,stack1,stack2];[d1,stack3,stack1];[d4,stack2,stack3];[d3,stack2,stack1];[d4,stack3,stack1];[d2,stack3,stack2];[d4,stack1,stack3];[d3,stack1,stack2];[d4,stack3,stack2];[d1,stack1,stack3];[d4,stack2,stack1];[d3,stack2,stack3];[d4,stack1,stack3];[d1,stack2,stack3]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[],[d2,d3,d4];[d1],[d3],[d2,d4];[d1,d3],[],[d2,d4];[d3],[],[d1,d2,d4];[],[d3],[d1,d2,d4];[],[d3,d4],[d1,d2];[d3,d4],[],[d1,d2];[],[d4],[d1,d2,d3];[d4],[d2],[d1,d3];[],[d2,d4],[d1,d3];[],[d2],[d1,d3,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[d3],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1,d4],[d2,d3],[];[d1,d4],[d2],[d3];[d1],[d2],[d3,d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d4],[d2,d3];[],[d1,d4],[d2,d3];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[],[d2,d3,d4];[d1],[d4],[d2,d3];[d1,d4],[],[d2,d3];[d1],[d4],[d2,d3];[],[d1],[d2,d3,d4];[],[d1,d4],[d2,d3];[],[d4],[d1,d2,d3];[],[d4],[d1,d2,d3];[d4],[],[d1,d2,d3];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1,d4],[d2,d3],[];[d1,d4],[d2],[d3];[d1],[d2,d4],[d3];[d1],[],[d3,d4];[],[d1],[d3,d4];[],[d1,d2,d4],[d3];[],[d1,d2],[d3,d4];[],[d1],[d2,d3,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1,d4],[d2,d3],[];[d1,d4],[d2],[d3];[d4],[d1],[d2,d3];[],[d1,d4],[d2,d3];[],[d4],[d1,d2,d3];[],[d2,d4],[d1,d3];[d4],[d2],[d1,d3];[d4],[d2,d3],[d1];[],[d2,d3,d4],[d1];[],[d2],[d1,d3,d4];
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,],[d4],[d3];[d1,d2],[],[d3,d4];[d1,],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d4],[d2,d3];[],[d1],[d4],[d2,d3];[],[d1,d4],[d2,d3];[d1],[d4],[d2,d3];[d1,d3],[d4],[d2];[d3],[d1,d4],[d2];[d3],[d1],[d2,d4];[d1,d3],[],[d2,d4];[d3],[d4],[d1,d2];[],[d3,d4],[d1,d2,];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[],[d1,d3,d4],[d2];[],[d3],[d1,d2,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1,d4],[d2,d3],[];[d1],[d2,d3,d4],[];[],[d2,d3,d4],[d1];[d4],[d2,d3],[d1];[d4],[d2],[d1,d3];[],[d2,d4],[d1,d3];[],[d4],[d1,d3,d2];[d3],[d4],[d1,d3,d2];[d3,d4],[],[d1,d3,d2];[],[],[d1,d3,d2,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[d1,d3],[d2,d4],[];[d3],[d1,d2,d4],[];[],[d1,d2,d3,d4],[];[],[d2,d3,d4],[d1];[d2],[d3,d4],[d1];[d2],[d3],[d1,d4];[],[d2],[d1,d3,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[d3,d4],[];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[],[d1,d3,d4],[d2];[],[d3],[d1,d2,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1,d4],[d2,d3],[];[d1,d4],[d2],[d3];[],[d2,d4],[d1,d3];[],[d2],[d1,d3,d4];[d3],[d2],[d1,d4];[d3],[d2,d4],[d1];[d3,d4],[d2], [d1];[d3,d4],[],[d1,d2];[d3],[d4],[d1,d2];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1,d4],[d2,d3],[];[d1,d4],[d2],[d3];[d4],[d1,d2],[d3];[d4],[],[d1,d2,d3];[],[d4],[d1,d2,d3];[],[d2,d4],[d1,d3];[d4],[d2],[d1,d3];[d3,d4],[d2],[d1];[d3,d4],[],[d1,d2];[],[d3,d4],[d1,d2];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[d3],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[],[d2,d3],[d1,d4];[],[d3],[d1,d2,d4];[],[d3,d4],[d1,d2];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d2,d3,d4],[d1],[];[d3,d4],[d1],[d2];[d3,d4],[],[d1,d2];[d4],[d3],[d1,d2];[d4],[d1,d3],[d2];[d1,d4],[d3],[d2];[d1,d4],[],[d2,d3];[],[d1,d2,d3],[d4];[d1],[d2,d3],[d2,d4];[d1],[d3],[d2,d4];[d2,d3],[d1],[d4];[d2,d3],[],[d1,d4];[d3],[d2],[d1,d4];[d3],[d1,d2],[d4];[],[d1,d2,d3],[d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[d3],[d1],[d2,d4];[d3,d4],[d1],[];[d4],[d1],[d2,d3];[d4],[],[d2,d3],[d1];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[d4],[];[d1,d2],[],[d3,d4];[d1],[d2,d4],[];[d1],[d2],[d3,d4];[d1],[],[d2,d3,d4];[],[d2,d4],[d1];[],[d2],[d1,d3,d4];[],[d2,d3,d4],[d1];[],[],[d1,d2,d3,d4];[],[d4],[d1,d3];[],[d3,d4],[d1,d2];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[],[d3],[d1,d2,d4];[],[d3,d4],[d1,d2];[],[d3,d4],[d1,d2];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[d3],[d1],[d2,d4];[d3,d4],[d1], [d2];[d3,d4],[],[d1,d2];[d4],[d3],[d1,d2];[d4],[],[d1,d2,d3];[],[d4],[d1,d2,d3]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2], [d3,d4],[];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[d4],[d1],[d2,d3];[d3,d4],[d1],[d2];[d3,d4],[d1,d2],[];[d2,d3,d4],[d1],[];[],[d1],[d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[d1,d3],[d2,d4],[];[d3],[d1,d2,d4],[];[],[d1,d2,d3,d4],[];[],[d2,d3],[d1,d4];[],[d3,d4],[d1,d2];[d3],[d4],[d1,d2];[d3],[],[d1,d2,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[d3],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[d4],[d1,d3],[];[d4],[d1],[d2,d3];[d3,d4],[d1],[];[d3,d4],[],[d1,d2];[d4],[d3],[];[d4],[],[d3];[],[d4],[]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d3],[d4];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1,d4],[d2], [d3];[d1],[d2,d4],[d3];[d1], [d2], [d3,d4];[], [d1,d2], [d3,d4];[],[d1,d2,d4],[d3];[d3], [d1,d2,d4],[];[d3,d4],[d1,d2],[];[d3],[d1,d2],[d4];[d3], [d1],[d2,d4];[],[d1,d2],[d3,d4];[],[d1,d2,d3],[d4];[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d4];[d1,d3,d4],[d2],[];[d1],[d2,d3,d4],[];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d4],[d2,d3];[d3],[d1,d4],[d2];[d3,d4],[d1],[d2];[d2,d3,d4],[d1],[];[d2],[d1,d3,d4],[];[d2],[],[d1,d3,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[],[d3],[d1,d2,d4];[],[d2,d3],[d1,d4];[d4],[d2,d3],[];[d3,d4],[d2],[];[d4],[d2,d3],[]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[],[d2,d3,d4];[d1],[d4],[d2,d3];[],[d1,d4],[d2,d3];[],[d4],[d1,d2,d3];[d3],[d4],[d1,d2];[d3,d4],[],[d1,d2];[d3],[d2,d4],[d1];[d3],[],[d1,d2,d4];[],[d3],[d1,d2,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[d3],[d1],[d2,d4];[d3,d4],[d1],[d2];[d3,d4],[d1,d2],[];[d3,d4],[d2],[d1];[d3],[d2,d4],[d1];[],[d2,d4],[d1,d3];[],[d4],[d1,d2,d3]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[],[d4];[d1],[d2,d3,d4],[];[];[d1,d3],[d2,d3,d4],[];[d3],[d2,d4],[d1];[d3,d4],[d2],[];[d4],[d1,d3],[],[d2];[d4],[d1,d3,d2],[];[];[d1,d3,d4],[d2];[]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[],[d2,d3,d4];[d1],[d3],[d2,d4];[d1,d3],[],[d2,d4];[d3],[],[d1,d2,d4];[],[d3],[d1,d2,d4];[],[d3,d4],[d1,d2];[d3],[d4],[d1,d2];[d2,d3],[],[d1,d4];[d2],[d3,d4],[d1];[d2],[],[d1,d3,d4];[],[d2],[d1,d3,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[d3],[d4];[d1],[d2],[d3,d4];[d1],[d3,d2],[];[d1],[d3,d2],[d4];[d1],[],[d3,d2,d4];[],[d1],[d3,d2,d4];[],[d1,d3],[d2,d4];[d4],[d1,d3],[];[d4],[d1],[d2,d3];[d1,d4],[],[d2,d3];[d1],[d4],[d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[d3],[d1],[d2,d3,d4];[d3],[d1,d3],[d2,d4];[d3,d4],[],[d2,d3,d4];[d3,d4],[d2],[d1,d3];[d4],[d2],[d1,d3,d4];[d4],[d2,d3],[]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d3,d4];[],[d2,d3],[d1,d4];[],[d2],[d1,d3,d4];[d3],[d2],[d1,d4];[d3,d4],[d2],[];[d3,d4],[],[d2];[d3],[d4],[d2];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[d3],[d4];[d1],[d2,d3],[d4];[d1],[d2],[d3,d4];[d1,d2],[],[d3];[d1],[],[d2,d3,d4];[d1],[],[d2,d3];[d1],[d3,d4],[];[d2],[d3,d4],[];[],[d2,d3,d4];[],[d2,d3],[d4];[],[d2],[d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[],[d2,d3,d4];[d1],[d4],[d2,d3];[d1,d4],[],[d2,d3];[],[],[d1,d2,d3,d4];[],[d4],[d1,d2,d3];[d4],[],[d1,d2,d3];[],[],[d1,d2,d3,d4];[d1],[d4],[d2,d3];[d1,d2],[d4],[];[d1,d2],[d4],[];[d1],[d2],[d3,d4];[],[d2,d4],[d3];[],[d2],[d3,d4]
?[d4,d3,d2,d1],[],[];[d3,d2,d1],[d4],[];[d3,d2,d1],[d4],[];[d3,d2,d1],[],[d4];[d3,d2],[d4],[d1];[d3,d2],[],[d1,d4];[d3,d2],[d1,d4],[];[d3,d2],[],[d4];[d3],[d1,d4],[d2];[d3],[d1],[d2,d4];[d3],[],[d1,d2,d4];[d3],[d4],[d1,d2];[],[d3,d4],[d1,d2];[],[d3],[d1,d2,d4];[d4],[d3],[d1,d2];[],[d3,d4],[d1,d2];[d4],[],[d1,d2,d3];[],[d4],[d1,d2,d3];[d3,d4],[],[d1,d2];[d3,d4],[],[d1,d2];[d3],[d4],[d1,d2];[],[d3,d4],[d1,d2];[d4],[],[d1,d2,d3];[],[d4],[d1,d2,d3];[d3,d4],[],[d1,d2];[d3,d4],[],[d1,d2];[d3],[d4],[d1,d2];[],[d3,d4],[d1,d2];[d4],[],[d1,d2,d3];[],[d4],[d1,d2,d3];[d3,d4],[],[d1,d2];[d3,d4],[],[d1,d2];[d3],[d4],[d1,d2];[],[d3,d4],[d1,d2];
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2], [d3],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[d1],[d3],[d2,d4];[d1],[d3,d4],[d2];[],[d1],[d2,d3,d4];[],[d1,d2],[d3,d4];[],[d1,d2,d3],[d4];[],[d1,d2,d3,d4],[]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[],[d2,d3,d4];[d1],[d4],[d2,d3];[d1,d4],[],[d2,d3];[],[d1,d4],[d2,d3];[d3,d4],[d1],[d2];[d3,d4],[],[d1,d2];[d2,d3,d4],[],[d1];[d2,d3],[d4],[d1];[d2,d3],[],[d1,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d2,d3,d4],[d1],[];[d3,d4],[d1],[d2];[d3,d4],[],[d1,d2];[d4],[d3],[d1,d2];[d1,d4],[d3],[,d2];[d1,d4],[d2,d3],[];[d4],[d1,d2,d3],[];[],[d1,d2,d3],[d4];[d2,d3],[d1],[d4];[d3],[d1,d2],[d4];[d3],[],[d1,d2,d4];[d1,d3],[],[d2,d4];[d3],[d1],[d2,d4];[],[d1,d3],[d2,d4];[],[d3],[d1,d2,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3];[d1,d2],[d4],[d3];[d1],[d2],[d3,d4];[d1],[],[d2];[d1],[d3],[d2,d4];[d1],[],[d2];[d1],[],[d2,d3,d4];[],[],[d1];[],[d4],[d1];[],[d3],[d1,d4];[],[d3,d4],[d1];[],[d2],[d1];[d4],[d2],[d1];[],[d2,d4],[d1];[],[d2],[d1,d3];[d4],[d2],[d1,d3];[],[d2,d4],[d1,d3];[],[d2],[d1,d3,d4];[],[d2,d3],[d1];[d4],[d2,d3],[d1];[],[d2,d3,d4],[d1];[],[d2],[d1,d3];[d4],[d2],[d1,d3];[],[d2,d4],[d1,d3];[],[],[d1,d2,d3];[d4],[],[d1,d2,d3];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d3],[d4];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d4],[d3];[d1],[d2,d3,d4],[];[],[d2,d3,d4],[d1];[],[d3,d4],[d1,d2];[d4],[d3],[d1,d2];[d4],[],[d1,d2,d3];[d4],[d2],[d1,d2,d3];[],[d2,d4],[d1,d2,d3];[],[d2,d3,d4],[d1,d2];[],[d3,d4],[d1,d2,d4];[],[d2,d3,d4],[]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d4],[d3,d2];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[d3],[d1,d2],[d4];[d3,d4],[d1,d2],[];[d3,d4],[d1],[d2];[d3,d4],[],[d2,d1];[d3],[d4],[d2,d1];[],[d4,d3],[d2,d1];[],[],[d2,d1,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d3,d4];[],[d2,d3],[d1,d4];[d3],[d2],[d1,d4];[d3],[],[d1,d2,d4];[d2,d3],[],[d1,d4];[d2],[d3,d4],[d1,d4];[],[d3,d4],[d1,d2];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[d1],[],[d2,d3,d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[d4],[d1,d3],[];[],[d1,d3,d4],[d2];[],[d1],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d3,d4,d2];[d1],[d4],[d3,d2];[],[d4],[d3,d2,d1];[],[d3,d4],[d2,d1];[d3,d4],[],[d2,d1];[d4],[d3],[d2,d1];[d4],[d2,d3], [d1];[d1,d4],[d2],[d3];[d1,d4],[],[d3,d2];[d1],[d4],[d3,d2]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3,d4],[d2];[],[d3,d4],[d1,d2];[d4],[d3],[d1,d2];[d4],[d1,d3],[d2];[],[d1,d3,d4],[d2];[],[d3,d4],[d1,d2,d3]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d4],[d3];[d1],[],[d2,d3,d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[],[d3],[d1,d2,d4];[],[d3,d4],[d1,d2];[],[d3],[d1,d2,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[d3],[d1],[d2,d4];[d3,d4],[d1], [d2];[d3,d4],[],[d1,d2];[d4],[d3],[d1,d2];[],[d3,d4],[d1,d2];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[d3],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1,d2,d3],[d4];[],[d1,d2],[d3,d4];[d3,d4],[d1,d2],[];[],[d1],[d2,d3,d4];[d4],[d1],[],[d3],[d1,d2],[d4];[],[d1,d3],[d2,d4];[],[d1],[d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d4],[d3];[d1],[d2,d3,d4],[];[d1,d4],[d2,d3],[];[d4],[d1],[d2,d3];[],[d1,d4],[d2,d3];[],[d1],[d2,d3,d4];[d2],[d1],[d3,d4];[d2,d4],[d1],,[d3];[d2,d4],[],[d1,d3];[d2],[d4],[d1,d3];[],[d2,d4],[d1,d3];[],[d2],[d1,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d3,d4];[],[d2,d3,d4];[],[d1],[d3,d4];[d3],[d1,d2],[d4];[d3,d4],[d1,d2],[];[d4],[d1,d2],[d3];[d1,d4],[d2],[];[d1],[d2,d4],[d3];[],[d2,d3,d4],[d1];[],[d3,d4],[d1,d2];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d4],[d2,d3];[],[d4],[d1,d2,d3];[],[d4],[d1,d2,d3];[],[d2,d4],[d1,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[d3],[d1],[d2,d4];[d3,d4],[d1],[];[d3],[d1],[d2,d4];[d3],[d1,d2],[d4];[],[d1,d2],[d3,d4];[],[d2],[d1,d3,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d4],[d3];[d1],[],[d3,d4,d2];[],[d1],[d3,d4,d2];[],[d1,d4],[d3,d2];[d3],[d1,d4],[d2];[d3,d4],[d1],[d2];[d3,d4],[d1,d2],[];[d3],[d4,d1,d2],[];[d3],[],[d4,d1,d2];[],[d3],[d4,d1,d2];[],[],[d3,d4,d1,d2]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[d1,d3],[d2,d4],[];[d3],[d1,d2,d4],[];[],[d1,d2,d3,d4],[];[],[d2,d3,d4],[d1];[d2],[d3,d4],[d1];[d2],[d3,d4,d1],[];[],[d3,d4,d1],[d2];[],[d4,d1],[d2,d3];[],[d1],[d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d2],[d3,d4];[d3],[d1,d2],[d4];[d3,d4],[d1,d2],[];[d4],[d1,d2],[d3];[d2,d4],[d1],[d3];[d2],[d1],[d3,d4];[],[d1,d2],[d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[d3],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[],[d2,d3,d4],[d1];[],[d3,d4],[d1,d2];[d3],[d4],[d1,d2];[d3,d4],[],[d1,d2];[d3],[d4],[d1,d2];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[d3],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[],[d3,d4],[d1,d2];[],[d4],[d1,d2,d3];[d4],[],[d1,d2,d3];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1,d4],[d2,d3],[];[d4],[d2,d3],[d1];[],[d2,d3,d4],[d1];[],[d3,d4],[d1,d2];[d4],[d3],[d1,d2];[d4],[d1,d3],[d2];[],[d1,d3,d4],[d2];[],[d3,d4],[d1,d2];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[d1,d4],[d2,d3],[];[d1,d4],[],[d2,d3];[d1],[d4],[d2,d3];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d4],[d2,d3];[],[d1],[d2,d3,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1,d4],[d2,d3],[];[d4],[d2,d3],[d1];[],[d2,d3,d4],[d1];[],[d3,d4],[d1,d2];[d3,d4],[],[d1,d2];[d3],[d4],[d1,d2];[d3],[d4,d2],[d1];[d3],[d2],[d1,d4];[],[d2,d3],[d1,d4];[],[d3],[d1,d2,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d2],[d3],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3], [d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[],[d3],[d1,d2,d4];[],[d3,d4],[d1,d2];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d4],[d3];[d1],[],[d3,d4,d2];[],[d2,d4],[d3,d1];[d1],[d2,d4],[d3];[],[d2,d4,d3],[d1];[],[d2,d4],[d1,d3];[],[d2],[d1,d3,d4];[d4],[d2],[d1,d3];[d4],[d2,d3],[d1];[],[d2,d3,d4],[d1];[],[d2,d3],[d1,d4];[],[d2],[d1,d4,d3];[d4],[d2],[d1,4,d3];[d4],[d2,d1],[d3];[],[d2,d1,d4],[d3];[],[d1,d4],[d2,d3];[],[d4],[d2,d3,d1];[d1],[d4],[d2,d3];[d1],[d2,d3,d4],[];[],[d2,d3,d4],[d1];[],[d2,d3],[d1,d4];[],[d2],[d1,d4,d3];[d4],[d2],[d1,d3];[d4],[],[d1,d3,d2]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[d3],[d1],[d2,d4];[d3,d4],[d1],[];[d3],[d1,d4],[d2];[d3],[],[d2,d4];[d1,d3],[],[d2,d4];[],[d3],[d1,d2,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[d1,d2,d3,d4],[],[];[d2,d3,d4],[d1],[];[d3,d4],[d1],[d2];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[d3],[d1],[d2,d4];[],[d1,d2,d4],[d3];[],[d2,d4],[d1,d3];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d3],[];[d1],[d2,d4],[];[d1],[d2],[d3,d4];[d1],[],[d2];[d1,d4],[],[d2,d3];[],[],[d1];[],[d2,d3,d4],[d1];[],[d2,d3],[d1,d4];[],[d2],[d3];[],[d2],[d3];[],[d2],[d3];[],[d2],[d3];[],[d2],[d3];[],[],[];[],[],[];[],[],[];[],[],[];[],[],[];[],[],[];[],[],[];[],[],[];[],[],[];[],[],[];[],[],[];[],[],[];[],[],[];[],[],[];[],[],[];[],[],[];[],[],[];[],[],[]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d4],[d3];[d1],[d2,d3,d4],[];[d1,d4],[d2,d3],[];[d1],[d2,d3,d4],[];[],[d2,d3],[d1,d4];[],[d2],[d1,d3,d4];[],[d2,d4],[d1,d3];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d2,d3,d4],[d1],[];[d3,d4],[d1],[d2];[d3,d4],[],[d1,d2];[d4],[d3],[d1,d2];[d1,d4],[d3], [d2];[d1,d4],[d2,d3],[];[d4],[d2,d3],[d1];[],[d2,d3,d4],[d1];[],[d3,d4],[d1,d2];[d1],[d3,d4],[d2];[d1],[d2,d3,d4],[];[],[d2,d3,d4],[d1];[],[d3,d4],[d1,d2];[d1],[d3,d4],[d2];[],[d3,d4],[d1,d2]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[d3],[d1],[d2,d4];[d3,d4],[d1],[];[d3,d4],[],[d1];[d2,d3,d4],[],[];[d2,d3],[d4],[d1];[d2,d3],[],[d1,d4];[d2],[d3],[d1,d4];[d2],[d3,d4],[d1];[],[d2],[d1,d3,d4];[],[d2,d3],[d1,d4];[d4],[d2,d3],[d1];[],[d2,d3,d4],[d1];[],[d2],[d1,d3,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[],[d3];[d1],[d2],[];[d1],[d2,d4],[d3];[d1],[d2],[d3,d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[d3],[d1,d3],[d2,d4];[],[],[d1,d2,d3,d4];[d3,d4],[d1],[d2];[],[d4],[d1,d2,d3];[d3,d4],[],[d1,d2];[d4],[],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[d3],[d4];[d1],[d2],[d3,d4];[d1],[d3,d4],[d2];[d1],[d4],[d2,d3];[],[d1],[d2,d3,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2,d4],[d3];[d1],[d2],[d3,d4];[d1],[d2,d3,d4],[];[],[d2,d3,d4],[d1];[],[d3,d4],[d1,d2];[d3,d4],[],[d1,d2];[d4],[d3],[d1,d2];[d4],[d1,d2,d3],[];[],[d1,d2,d3],[d4];[],[d1,d2],[d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[],[d3],[d1,d2,d4];[],[d3,d4],[d1,d2];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,],[d4],[d3];[d1,d2],[],[d3,d4];[d1,],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d4,d3,d2];[],[d1],[d4,d3,d2];[d4],[d1,d3],[d2];[d4,d3],[d1],[d2];[d4,d3,d1],[],[d2];[d4,],[d3],[d2,d1];[d4],[d3,d1],[d2];[],[d3,d1,d4],[d2];[],[d1],[d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[d4],[];[d1,d2],[],[d4,d3];[d1],[d2,d4],[];[d1],[d2],[d4,d3];[d1],[],[d2,d4,d3];[],[d1],[d2,d4,d3];[],[d1,d4],[d2,d3];[],[d4],[d1,d2,d3];[],[d2,d4,d3],[d1];[],[d2,d3],[d1,d4];[],[d3],[d1,d2,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[d3],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[d3,d4],[d2],[d1];[d3,d4],[d1,d2],[];[d3],[d1,d2,d4],[];[d3],[d1,d2],[d4];[],[d1,d2,d3],[d4];[],[d2,d3],[d1,d4];[],[d2,d3,d4],[d1]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3,d4],[d2];[d3],[d1],[d2,d4];[d3,d4],[d1],[d2];[d3,d4],[],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3,d1],[d2];[],[d3,d1,d2],[d4];[],[d1,d2],[d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d2,d3,d4],[];[d1,],[d2,d3,d4],[];[],[d2,d3,d4],[d1];[],[d3,d4],[d1,d2];[d3,d4],[],[d1,d2];[d4],[d3],,[d1,d2];[d4],[d3],[d1,d2];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[d3],[d1,d2],[d4];[d3,d4],[d1,d2],[];[d4],[d1,d2],[d3];[],[d1,d2,d4],[d3];[],[d2,d4],[d1,d3];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d2,d3,d4],[d1],[];[d3,d4],[d1],[d2];[d3,d4],[],[d1,d2];[d4],[d3], [d1,d2];[d1,d4],[d3], [d2];[d1,d4],[d2,d3], [];[d4],[d2,d3],[d1];[d4],[d3],[d1,d2];[],[d2,d3,d4],[d1];[d1],[d3,d4],[d2];[d1],[d4],[d2,d3];[d2],[d1,d4],[d3];[d2], [d4],[d1,d3];[],[d2,d4],[d1,d3];[],[d4],[d1,d2,d3]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[d3],[d1],[d2,d4];[d3],[],[d1,d2,d4];[d2,d3],[d4],[d1];[d2,d3],[],[d1,d4];[d2],[d3],[d1,d4];[],[d2,d3,d4],[d1]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[],[d4];[d1,d2],[d3],[d4];[d1,d2],[d3,d4],[];[d1],[d3,d4],[d2];[d1,d4],[d3],[d2];[d1,d4],[],[d2,d3];[d4],[d1],[d2,d3];[d4],[d1,d2,d3],[];[],[d1,d2,d3],[d4];[d3],[d1,d2],[d4];[d3,d4],[d1,d2],[];[d3,d4],[d1],[d2];[d3],[d1],[d2,d4];[d3],[d1,d2,d4],[];[d3],[d2,d4],[d1];[d3,d4],[d2],[d1];[d3,d4],[],[d1,d2];[d4],[d3],[d1,d2];[d2],[d3,d4],[d1];[d2],[d3],[d1,d4];[d2,d4],[d3], [d1];[d2,d4],[],[d1,d3];[d4],[d2],[d1,d3];[d4],[d2,d1,d3],[];[],[d2,d1,d3],[d4];[d3],[d2,d1],[d4];[d3,d4],[d2,d1],[];[d3,d4],[d1],[d2];[d3],[d1],[d2,d4];[d3],[d1,d2,d4],[];[d3,d4],[d1,d2],[]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d3],[d2,d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[],[d3],[d1,d2,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[],[d3,d4];[d1,d2],[d3],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[d3],[d1],[d2,d4];[],[d1,d3,d4],[d2];[],[d3,d4],[d1,d2];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d2,d3,d4],[d1],[];[d3,d4],[d1],[d2];[d3,d4],[],[d1,d2];[d4],[d3],[d1,d2];[d4],[d1,d3],[d2];[d1,d4],[d3],[d2];[d1,d4],[d3,d2],[];[d4],[d1,d3,d2],[];[d4],[],[d1,d3,d2];[],[d4],[d1,d3,d2];[],[d2,d4],[d1,d3];[d1],[d2,d4],[d3];[d1],[d4],[d2,d3];[],[d1,d4],[d2,d3];[],[d4],[d1,d2,d3]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d4],[d3];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[d4],[d1],[d2,d3];[d4],[d1,d3],[d2];[],[d1,d3,d4],[d2];[],[d3,d4],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3],[d1,d2];[d4],[d3],[d1,d2];
?[d4,d3,d2,d1],[],[];[d3,d2,d1],[d4],[];[d3,d2,d1],[d4],[];[d2,d1],[d4],[d3];[d2,d1],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2],[d4,d3];[d4,d3,d1],[d2],[];[d4,d3],[d2,d1],[];[d4,d3],[],[d2,d1];[d4],[d3],[d2,d1];[d4],[d3],[d1,d2];[],[d4],[d1,d2,d3];[],[d4,d3],[d1,d2];[d4],[d3],[d1,d2];[d1,d2],[d3,d4],[];[],[d3,d4],[d1,d2];[d1,d2],[d4],[d3];[d4,d3],[d1,d2],[];[d4,d3],[],[d1,d2];[d4],[d3],[d1,d2];[d2,d1],[d3,d4],[];[d2,d1],[],[d3,d4];[d4],[d3],[d1,d2];[d1,d2],[d3,d4],[];[d1,d2],[d4],[d3];[d2],[d3],[d1];[d2],[d1,d3],[d4];[],[d1,d3],[d2,d4];[],[d3],[d1,d2];[],[d3,d4],[d1,d2];[d4],[d3],[d1,d2];[],[d3,d4],[d1,d2];[d4,d3],[d1,d2],[]
?Okay, here's the Tower of Hanoi solution for 4 disks represented as stack states, separated by semicolons:

`[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2], [d4];[d1,d3,d4],[d2],[];[d1,d4],[d2,d3],[];[d1],[d2,d3,d4],[];[],[d2,d3,d4],[d1];[],[d3,d4],[d1,d2];[d3],[d4],[d1,d2];[d3,d4],[],[d1,d2];[d4],[d2],[d1,d3];[],[d2,d4],[d1,d3];[],[d4],[d1,d2,d3];[],[],[d1,d2,d3,d4]`
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d4],[d2,d3];[d3],[d1,d4],[d2];[d3,d4],[d1],[d2];[d3],[d1],[d2,d4];[d3],[],[d2,d4];[d3],[],[d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d4],[d3];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[d4],[d1],[d2,d3];[d4],[d1,d3],[d2];[],[d1,d3,d4],[d2];[],[d3,d4],[d1,d2];[d4],[d3],[d1,d2];[d4],[d2,d3],[d1];[],[d2,d3,d4],[d1];[],[d2,d3],[d1,d4];[d4],[d2,d3],[d1];[d4],[d2],[d1,d3];[d2,d4],[],[d1,d3];[d2],[d1],[d3,d4];[d2],[d1,d4],[d3];[],[d1,d3,d4],[d2];[],[d3,d4],[d1,d2];[d4],[d3],[d1,d2];[d4],[d2,d3],[d1];[],[d2,d3,d4],[d1];[],[d2,d3],[d1,d4];[d4],[d2,d3],[d1];[d4],[d2],[d1,d3];[d2,d4],[],[d1,d3];[d2],[d1],[d3,d4];[d2],[d1,d4],[d3];[],[d1,d3,d4],[d2];[],[d3,d4],[d1,d2];[d4],[d3],[d1,d2];[d4],[d2,d3],[d1];[],[d2,d3,d4],[d1];
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[d3],[d1],[d2,d4];[d3,d4],[d1],[],[d3,d4],[d1,d2],[];[d3],[d1,d2],[d4];[d3],[],[d2,d4];[],[d3],[d2,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,d3],[],[d4];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[d3],[d1],[d2,d4];[d3,d4],[d1],[];[d3,d4],[d1,d2],[];[d4],[d1,d2],[d3];[d4],[],[d1,d2,d3];[],[d4],[d1,d2,d3]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d3],[d4];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1,d4],[d2], [d3];[d1],[d2,d4],[d3];[d1], [d2], [d3,d4];[],[d1,d2],[d3,d4];[],[d1],[d2,d3,d4];[d3],[d1],[d2,d4];[d3,d4],[d1],[d2];[d3],[d1,d4],[d2];[d3], [d1], [d2,d4];[],[d1,d3],[d2,d4];[],[d1],[d2,d3,d4];[],[d1,d2,d3],[d4];[d4],[d1,d2,d3],[];[d4],[d1,d2],[d3];[d2,d4],[d1],[d3];[d4],[d1,d2],[d3];[d3,d4],[d1,d2],[];[d3],[d1,d2,d4],[];[d3],[d1,d2],[d4];[d3,d4],[d1],[d2];[d3],[d1,d4],[d2];[d3],[d1],[d2,d4];[d3],[d1,d2],[d4];[],[d1,d2,d3],[d4];[],[d1,d2],[d3,d4];[d4],[d1,d2],[d3];
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2,],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[d3],[d2,d4];[d1,d3],[],[d2,d4];[],[d3],[d1,d2,d4];[d3],[],[d1,d2,d4];[],[d3,d4],[d1,d2];[],[d4],[d1,d2,d3];[d4],[d2],[d1,d3];[],[d2,d4],[d1,d3];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d2,d3,d4],[d1],[];[d3,d4],[d1],[d2];[d3,d4],[],[d1,d2];[d4],[d3],[d1,d2];[d1,d4],[d3], [d2];[d1,d4],[d2,d3],[];[d4],[d2,d3],[d1];[],[d2,d3,d4],[d1];[],[d3,d4],[d1,d2];[d1],[d3,d4],[d2];[d1],[d4],[d2,d3];[],[d1,d4],[d2,d3];[],[d4],[d1,d2,d3];[d1],[],[d2,d3,d4];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1,d4],[d2,d3],[];[d4],[d2,d3],[d1];[d4],[d3],[d1,d2];[],[d3,d4],[d1,d2];[],[d4],[d1,d2,d3];[d2],[d4],[d1,d2,d3];[d2,d4],[],[d1,d2,d3];[d4],[],[d1,d2,d3];[],[d4],[d1,d2,d3,d4]
?Okay, here's the solution formatted as requested, showing the disk moved in each step, and the origin and destination pegs.

d4:stack1,stack3;d3:stack1,stack2;d4:stack3,stack2;d2:stack1,stack3;d4:stack2,stack1;d3:stack2,stack3;d4:stack1,stack3;d1:stack1,stack2;d4:stack3,stack2;d3:stack3,stack1;d4:stack2,stack1;d2:stack3,stack2;d4:stack1,stack3;d3:stack1,stack2;d4:stack3,stack2;d1:stack2,stack3;d4:stack2,stack1;d3:stack2,stack3;d4:stack1,stack3;d2:stack2,stack1;d4:stack3,stack2;d3:stack3,stack1;d4:stack2,stack1;d1:stack3,stack1;d4:stack1,stack3;d3:stack1,stack2;d4:stack3,stack2;d2:stack1,stack3;d4:stack2,stack1;d3:stack2,stack3;d4:stack1,stack3
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1],[d2],[d3,d4];[d1],[d2,d4],[d3];[d1],[d2,d3,d4],[];[d1,d4],[d2,d3],[];[d1,d4],[],[d2,d3];[d1],[d4],[d2,d3];[d1],[d2,d3,d4],[];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d4],[d2,d3];[],[d1,d3,d4],[d2];[],[],[d1,d2,d3,d4]
?[d1,d2,d3,d4],[],[];[d1,d2,d3],[d4],[];[d1,d2],[d4],[d3];[d1,d2],[],[d3,d4];[d1,d3],[d2],[d4];[d1],[d2],[d3,d4];[d1],[d2,d3],[d4];[d1],[],[d2,d3,d4];[],[d1],[d2,d3,d4];[],[d1,d3],[d2,d4];[d3],[d1],[d2,d4];[d3,d4],[d1],[],[d3,d4],[d1,d2],[];[d3],[d1,d2],[d4];[d3],[],[d2,d4];[],[d3],[d2,d4];[],[],[d1,d2,d3,d4]
?